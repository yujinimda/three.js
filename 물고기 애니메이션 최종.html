<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸŸ Sì í—¤ì—„ì¹˜ë©° ë–¨ì–´ì§€ëŠ” íë¸Œ</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background: linear-gradient(to bottom, #001122, #003366);
        font-family: Arial, sans-serif;
        overflow: hidden;
      }

      #info {
        position: absolute;
        top: 10px;
        left: 10px;
        color: white;
        z-index: 100;
        background: rgba(0, 0, 0, 0.7);
        padding: 15px;
        border-radius: 10px;
        border: 2px solid #00ffff;
      }

      #controls {
        position: absolute;
        bottom: 20px;
        left: 20px;
        color: white;
        background: rgba(0, 0, 0, 0.7);
        padding: 10px;
        border-radius: 8px;
      }

      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <div id="info">
      <h3>Sì í—¤ì—„ì¹˜ë©° ë–¨ì–´ì§€ëŠ” íë¸Œ</h3>
      <p><strong>íœ  ë‚´ë¦¬ê¸°:</strong> Sìë¡œ í—¤ì—„ì¹˜ë©° ì•„ë˜ë¡œ</p>
      <p><strong>íœ  ì˜¬ë¦¬ê¸°:</strong> Sìë¡œ í—¤ì—„ì¹˜ë©° ìœ„ë¡œ</p>
      <p><strong>ìë™:</strong> ë¬¼ê³ ê¸°ì²˜ëŸ¼ í”ë“¤í”ë“¤</p>
    </div>

    <div id="controls">
      <p>Yìœ„ì¹˜: <span id="yPos">0</span></p>
      <p>Xìœ„ì¹˜: <span id="xPos">0</span></p>
      <p>í—¤ì—„ì†ë„: <span id="swimSpeed">ë³´í†µ</span></p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
      // === ì”¬ ê¸°ë³¸ ì„¤ì • ===
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      const renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setClearColor(0x001133);
      document.body.appendChild(renderer.domElement);

      // === ë¬¼ê³ ê¸° íë¸Œ ìƒì„± ===
      const geometry = new THREE.BoxGeometry(1.5, 1, 2);
      const material = new THREE.MeshBasicMaterial({
        color: 0x00ff88,
        wireframe: false,
      });
      const fishCube = new THREE.Mesh(geometry, material);
      scene.add(fishCube);

      // === ì• ë‹ˆë©”ì´ì…˜ ë³€ìˆ˜ë“¤ ===
      let time = 0;
      let targetY = 0;
      let currentY = 0;
      let isScrolling = false;
      let scrollSpeed = 0;
      let sWaveOffset = 0; // Sì ì›€ì§ì„ì„ ìœ„í•œ ì˜¤í”„ì…‹

      // === íœ  ì´ë²¤íŠ¸ ===
      document.addEventListener("wheel", (event) => {
        // íœ  ë°©í–¥ì— ë”°ë¼ ìœ„ì•„ë˜ ì´ë™ (ë” ì²œì²œíˆ)
        targetY -= event.deltaY * 0.008;
        scrollSpeed = Math.abs(event.deltaY * 0.0005);
        isScrolling = true;

        // Sì ì›€ì§ì„ì„ ìœ„í•œ ì˜¤í”„ì…‹ ì¦ê°€ (ë” ì²œì²œíˆ)
        sWaveOffset += Math.abs(event.deltaY) * 0.0003;

        setTimeout(() => {
          isScrolling = false;
          scrollSpeed *= 0.5;
        }, 500);
      });

      // === ì¹´ë©”ë¼ ì„¤ì • ===
      camera.position.z = 8;

      // === ë©”ì¸ ì• ë‹ˆë©”ì´ì…˜ í•¨ìˆ˜ ===
      function animate() {
        requestAnimationFrame(animate);
        time += 0.016; // ëŒ€ëµ 60fps

        // ğŸŸ ë¬¼ê³ ê¸° ê¸°ë³¸ í—¤ì—„ì¹˜ê¸° íŒ¨í„´ (í•­ìƒ í”ë“¤í”ë“¤)
        const baseSwimIntensity = 1;
        const scrollSwimIntensity = isScrolling ? 1.5 + scrollSpeed * 8 : 1; // ëœ ê²©ë ¬í•˜ê²Œ

        // ê¸°ë³¸ ì¢Œìš° ê¼¬ë¬¼ê±°ë¦¼ (ê¼¬ë¦¬ í”ë“¤ê¸°)
        const baseRotation = Math.sin(time * 3) * 0.2;
        fishCube.rotation.y = baseRotation * baseSwimIntensity;

        // ê¸°ë³¸ ìƒí•˜ ë¯¸ì„¸í•œ íŒŒë™
        const baseVerticalWave = Math.sin(time * 4) * 0.02;

        // Sì í—¤ì—„ì¹˜ë©° ì´ë™í•˜ê¸°
        if (isScrolling || Math.abs(targetY - currentY) > 0.05) {
          // Yì¶• ì´ë™ (ë” ë¶€ë“œëŸ½ê²Œ)
          currentY += (targetY - currentY) * 0.04;
          fishCube.position.y = currentY + baseVerticalWave;

          // Sì íŒ¨í„´ ë§Œë“¤ê¸° (-2 ~ 2 ë²”ìœ„)
          const yMovement = currentY * 0.4; // Y ì´ë™ëŸ‰ (ë” ì²œì²œíˆ)
          const sWave = Math.sin(yMovement + sWaveOffset * 3) * 2.0; // -2~2 ë²”ìœ„
          fishCube.position.x = sWave;

          // ì´ë™í•  ë•Œ í—¤ì—„ì¹˜ê¸° (ë” ìì—°ìŠ¤ëŸ½ê²Œ)
          fishCube.rotation.y =
            baseRotation * scrollSwimIntensity +
            Math.sin(yMovement + sWaveOffset * 3) * 0.2;

          // ì•ë’¤ ì¶”ì§„ë ¥ (ë” ë¶€ë“œëŸ½ê²Œ)
          fishCube.position.z = Math.sin(time * 4) * 0.05 * scrollSwimIntensity;
        } else {
          // ì •ì§€ ìƒíƒœì—ì„œëŠ” í˜„ì¬ Xìœ„ì¹˜ì—ì„œ ë©ˆì¶¤ (ì¤‘ì•™ ë³µê·€ ì•ˆí•¨)
          fishCube.position.y += baseVerticalWave;
          // fishCube.position.xëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ (ë§ˆì§€ë§‰ Sì ìœ„ì¹˜ì—ì„œ ë©ˆì¶¤)
          fishCube.position.z += (0 - fishCube.position.z) * 0.02; // zë§Œ ì›ë˜ ìœ„ì¹˜ë¡œ
        }

        // ì •ë³´ ì—…ë°ì´íŠ¸
        document.getElementById("yPos").textContent =
          fishCube.position.y.toFixed(2);
        document.getElementById("xPos").textContent =
          fishCube.position.x.toFixed(2);
        document.getElementById("swimSpeed").textContent = isScrolling
          ? "ë¹ ë¦„!"
          : "ë³´í†µ";

        // ë Œë”ë§
        renderer.render(scene, camera);
      }

      // === ë¦¬ì‚¬ì´ì¦ˆ ëŒ€ì‘ ===
      window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });

      // === ì‹œì‘! ===
      animate();
      console.log("Sì í—¤ì—„ì¹˜ëŠ” íë¸Œ ì‹œì‘!");
    </script>
  </body>
</html>
